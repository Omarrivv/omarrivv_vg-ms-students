pipeline {
    agent any
    
    stages {
        stage('üß™ Test Slack HTTP') {
            steps {
                script {
                    // M√©todo directo HTTP sin plugin
                    def slackMessage = [
                        text: "üéâ *TEST DIRECTO HTTP*\n‚è∞ ${new Date()}\n‚úÖ Slack + Jenkins funcionando sin plugin!"
                    ]
                    
                    withCredentials([string(credentialsId: 'slack-webhook', variable: 'WEBHOOK_URL')]) {
                        def response = httpRequest(
                            httpMode: 'POST',
                            url: "${WEBHOOK_URL}",
                            contentType: 'APPLICATION_JSON',
                            requestBody: groovy.json.JsonOutput.toJson(slackMessage)
                        )
                        
                        echo "Response: ${response.status}"
                    }
                }
            }
        }
    }
}